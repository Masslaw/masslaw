# this cloud formation stack will consist of all the masslaw backend logic handlers
# serverless deploy --config sls-masslawFileProcessing.yml --stage <stage>

service: masslawFileProcessing
frameworkVersion: '3'

provider:
  name: aws
  runtime: python3.8
  region: us-east-1
  deploymentMethod: direct
  stage: ${opt:stage, 'dev'}
  environment:
    STAGE: ${self:provider.stage}

package:
  individually: true
  patterns:
    - '!**'

functions:
  case-file-pipeline-start:
    handler: lambda_src/handlers/case_file_processing/pipeline_steps/case_file_pipeline_start.handler.handler
    role: arn:aws:iam::746826375642:role/MasslawCaseFilePipelineLambdaLogicHandler
    package:
      patterns:
        - lambda_src/handlers/case_file_processing/pipeline_steps/case_file_pipeline_start/**
        - lambda_src/components/lambda_base/**
        - lambda_src/components/cloudwatch_manager/**
        - lambda_src/components/networking/**
        - lambda_src/components/util/**
        - lambda_src/components/dynamoDB_manager/**
        - lambda_src/components/masslaw_case_file_processing_pipeline_manager/**
        - lambda_src/components/masslaw_cases/**
        - lambda_src/components/masslaw_cloud_configurations/**
        - lambda_src/components/batch_manager/**
        - lambda_src/components/mlcp/**
        - lambda_src/components/S3_manager/**
        - lambda_src/components/opensearch_manager/**
    environment:
      deployed: true

  case-file-pipeline-success:
    handler: lambda_src/handlers/case_file_processing/pipeline_steps/case_file_pipeline_success.handler.handler
    role: arn:aws:iam::746826375642:role/MasslawCaseFilePipelineLambdaLogicHandler
    package:
      patterns:
        - lambda_src/handlers/case_file_processing/pipeline_steps/case_file_pipeline_success/**
        - lambda_src/components/lambda_base/**
        - lambda_src/components/cloudwatch_manager/**
        - lambda_src/components/networking/**
        - lambda_src/components/util/**
        - lambda_src/components/dynamoDB_manager/**
        - lambda_src/components/masslaw_case_file_processing_pipeline_manager/**
        - lambda_src/components/masslaw_cases/**
        - lambda_src/components/masslaw_cloud_configurations/**
        - lambda_src/components/batch_manager/**
        - lambda_src/components/mlcp/**
        - lambda_src/components/S3_manager/**
        - lambda_src/components/opensearch_manager/**
    environment:
      deployed: true

  case-file-pipeline-fail:
    handler: lambda_src/handlers/case_file_processing/pipeline_steps/case_file_pipeline_fail.handler.handler
    role: arn:aws:iam::746826375642:role/MasslawCaseFilePipelineLambdaLogicHandler
    package:
      patterns:
        - lambda_src/handlers/case_file_processing/pipeline_steps/case_file_pipeline_fail/**
        - lambda_src/components/lambda_base/**
        - lambda_src/components/cloudwatch_manager/**
        - lambda_src/components/networking/**
        - lambda_src/components/util/**
        - lambda_src/components/dynamoDB_manager/**
        - lambda_src/components/masslaw_case_file_processing_pipeline_manager/**
        - lambda_src/components/masslaw_cases/**
        - lambda_src/components/masslaw_cloud_configurations/**
        - lambda_src/components/batch_manager/**
        - lambda_src/components/mlcp/**
        - lambda_src/components/S3_manager/**
        - lambda_src/components/opensearch_manager/**
    environment:
      deployed: true

  text-extraction-start:
    handler: lambda_src/handlers/case_file_processing/pipeline_steps/text_extraction_start.handler.handler
    role: arn:aws:iam::746826375642:role/MasslawCaseFilePipelineLambdaLogicHandler
    package:
      patterns:
        - lambda_src/handlers/case_file_processing/pipeline_steps/text_extraction_start/**
        - lambda_src/components/lambda_base/**
        - lambda_src/components/cloudwatch_manager/**
        - lambda_src/components/networking/**
        - lambda_src/components/util/**
        - lambda_src/components/dynamoDB_manager/**
        - lambda_src/components/masslaw_case_file_processing_pipeline_manager/**
        - lambda_src/components/masslaw_cases/**
        - lambda_src/components/masslaw_cloud_configurations/**
        - lambda_src/components/batch_manager/**
        - lambda_src/components/mlcp/**
        - lambda_src/components/S3_manager/**
        - lambda_src/components/opensearch_manager/**
    environment:
      deployed: true

  text-extraction-fail:
    handler: lambda_src/handlers/case_file_processing/pipeline_steps/text_extraction_fail.handler.handler
    role: arn:aws:iam::746826375642:role/MasslawCaseFilePipelineLambdaLogicHandler
    package:
      patterns:
        - lambda_src/handlers/case_file_processing/pipeline_steps/text_extraction_fail/**
        - lambda_src/components/lambda_base/**
        - lambda_src/components/cloudwatch_manager/**
        - lambda_src/components/networking/**
        - lambda_src/components/util/**
        - lambda_src/components/dynamoDB_manager/**
        - lambda_src/components/masslaw_case_file_processing_pipeline_manager/**
        - lambda_src/components/masslaw_cases/**
        - lambda_src/components/masslaw_cloud_configurations/**
        - lambda_src/components/batch_manager/**
        - lambda_src/components/mlcp/**
        - lambda_src/components/S3_manager/**
        - lambda_src/components/opensearch_manager/**
    environment:
      deployed: true

  text-extraction-success:
    handler: lambda_src/handlers/case_file_processing/pipeline_steps/text_extraction_success.handler.handler
    role: arn:aws:iam::746826375642:role/MasslawCaseFilePipelineLambdaLogicHandler
    package:
      patterns:
        - lambda_src/handlers/case_file_processing/pipeline_steps/text_extraction_success/**
        - lambda_src/components/lambda_base/**
        - lambda_src/components/cloudwatch_manager/**
        - lambda_src/components/networking/**
        - lambda_src/components/util/**
        - lambda_src/components/dynamoDB_manager/**
        - lambda_src/components/masslaw_case_file_processing_pipeline_manager/**
        - lambda_src/components/masslaw_cases/**
        - lambda_src/components/masslaw_cloud_configurations/**
        - lambda_src/components/batch_manager/**
        - lambda_src/components/mlcp/**
        - lambda_src/components/S3_manager/**
        - lambda_src/components/opensearch_manager/**
    environment:
      deployed: true

  submit-to-search-index:
    handler: lambda_src/handlers/case_file_processing/pipeline_steps/submit_to_search_index.handler.handler
    role: arn:aws:iam::746826375642:role/MasslawCaseFilePipelineLambdaLogicHandler
    package:
      patterns:
        - lambda_src/handlers/case_file_processing/pipeline_steps/submit_to_search_index/**
        - lambda_src/components/lambda_base/**
        - lambda_src/components/cloudwatch_manager/**
        - lambda_src/components/networking/**
        - lambda_src/components/util/**
        - lambda_src/components/dynamoDB_manager/**
        - lambda_src/components/masslaw_case_file_processing_pipeline_manager/**
        - lambda_src/components/masslaw_cases/**
        - lambda_src/components/masslaw_cloud_configurations/**
        - lambda_src/components/batch_manager/**
        - lambda_src/components/mlcp/**
        - lambda_src/components/S3_manager/**
        - lambda_src/components/opensearch_manager/**
    environment:
      deployed: true

  text-processing-start:
    handler: lambda_src/handlers/case_file_processing/pipeline_steps/text_processing_start.handler.handler
    role: arn:aws:iam::746826375642:role/MasslawCaseFilePipelineLambdaLogicHandler
    package:
      patterns:
        - lambda_src/handlers/case_file_processing/pipeline_steps/text_processing_start/**
        - lambda_src/components/lambda_base/**
        - lambda_src/components/cloudwatch_manager/**
        - lambda_src/components/networking/**
        - lambda_src/components/util/**
        - lambda_src/components/dynamoDB_manager/**
        - lambda_src/components/masslaw_case_file_processing_pipeline_manager/**
        - lambda_src/components/masslaw_cases/**
        - lambda_src/components/masslaw_cloud_configurations/**
        - lambda_src/components/batch_manager/**
        - lambda_src/components/mlcp/**
        - lambda_src/components/S3_manager/**
        - lambda_src/components/opensearch_manager/**
    environment:
      deployed: true

  text-processing-fail:
    handler: lambda_src/handlers/case_file_processing/pipeline_steps/text_processing_fail.handler.handler
    role: arn:aws:iam::746826375642:role/MasslawCaseFilePipelineLambdaLogicHandler
    package:
      patterns:
        - lambda_src/handlers/case_file_processing/pipeline_steps/text_processing_fail/**
        - lambda_src/components/lambda_base/**
        - lambda_src/components/cloudwatch_manager/**
        - lambda_src/components/networking/**
        - lambda_src/components/util/**
        - lambda_src/components/dynamoDB_manager/**
        - lambda_src/components/masslaw_case_file_processing_pipeline_manager/**
        - lambda_src/components/masslaw_cases/**
        - lambda_src/components/masslaw_cloud_configurations/**
        - lambda_src/components/batch_manager/**
        - lambda_src/components/mlcp/**
        - lambda_src/components/S3_manager/**
        - lambda_src/components/opensearch_manager/**
    environment:
      deployed: true

  text-processing-success:
    handler: lambda_src/handlers/case_file_processing/pipeline_steps/text_processing_success.handler.handler
    role: arn:aws:iam::746826375642:role/MasslawCaseFilePipelineLambdaLogicHandler
    package:
      patterns:
        - lambda_src/handlers/case_file_processing/pipeline_steps/text_processing_success/**
        - lambda_src/components/lambda_base/**
        - lambda_src/components/cloudwatch_manager/**
        - lambda_src/components/networking/**
        - lambda_src/components/util/**
        - lambda_src/components/dynamoDB_manager/**
        - lambda_src/components/masslaw_case_file_processing_pipeline_manager/**
        - lambda_src/components/masslaw_cases/**
        - lambda_src/components/masslaw_cloud_configurations/**
        - lambda_src/components/batch_manager/**
        - lambda_src/components/mlcp/**
        - lambda_src/components/S3_manager/**
        - lambda_src/components/opensearch_manager/**
    environment:
      deployed: true
